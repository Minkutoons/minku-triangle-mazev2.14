<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Rock n Roll: Ball Maze Challenge â€“ Minku</title>
<style>
body{margin:0;background:#111;color:#fff;font-family:Arial}
#top{padding:8px;background:#1a1a1a;display:flex;gap:10px;align-items:center}
button{padding:6px 10px;border-radius:6px;border:none;background:#333;color:#fff}
canvas{display:block;width:100vw;height:90vh;touch-action:none}
</style>
</head>
<body>

<div id="top">
<button id="restart">Restart</button>
<button id="comfort">Comfort: ON</button>
<span id="info">L1</span>
</div>

<canvas id="cv"></canvas>

<script>
const cv = document.getElementById("cv");
const ctx = cv.getContext("2d");

function resize(){
  cv.width = window.innerWidth;
  cv.height = window.innerHeight*0.9;
}
resize();
window.onresize = resize;

/* ---------- LEVEL SYSTEM ---------- */
let level = 1;
function shapeForLevel(L){
  if(L===1) return "triangle";
  if(L===2) return "square";
  if(L===3) return "rect";
  if(L===4) return "square";
  return "circle"; // unlock at 5
}

/* ---------- COMFORT MODE ---------- */
let comfortMode = true;
document.getElementById("comfort").onclick = ()=>{
  comfortMode = !comfortMode;
  document.getElementById("comfort").textContent =
    "Comfort: " + (comfortMode?"ON":"OFF");
};

/* ---------- BALL ---------- */
let ball = {x:100,y:100,vx:0,vy:0,r:12};

function resetBall(){
  ball.x = cv.width/2;
  ball.y = cv.height/2 - 150;
  ball.vx = ball.vy = 0;
}
resetBall();

document.getElementById("restart").onclick = resetBall;

/* ---------- TILT ---------- */
let tiltX=0, tiltY=0;
window.addEventListener("deviceorientation",(e)=>{
  let gx=e.gamma||0;
  let by=e.beta||0;
  if(comfortMode){
    tiltX = by/30;
    tiltY = -gx/30;
  }else{
    tiltX = gx/30;
    tiltY = by/30;
  }
});

/* ---------- DRAW SHAPES ---------- */
function drawShape(shape){
  let cx=cv.width/2;
  let cy=cv.height/2;
  let R=200;

  ctx.strokeStyle="#555";
  ctx.lineWidth=6;

  ctx.beginPath();
  if(shape==="circle"){
    ctx.arc(cx,cy,R,0,Math.PI*2);
  }
  if(shape==="square"){
    ctx.rect(cx-R,cy-R,R*2,R*2);
  }
  if(shape==="rect"){
    ctx.rect(cx-R*1.2,cy-R*0.7,R*2.4,R*1.4);
  }
  if(shape==="triangle"){
    // upright triangle
    ctx.moveTo(cx,cy-R);
    ctx.lineTo(cx+R*Math.cos(Math.PI/6),cy+R*Math.sin(Math.PI/6));
    ctx.lineTo(cx-R*Math.cos(Math.PI/6),cy+R*Math.sin(Math.PI/6));
    ctx.closePath();
  }
  ctx.stroke();
}

/* ---------- LOOP ---------- */
function loop(){
  ctx.clearRect(0,0,cv.width,cv.height);

  let shape = shapeForLevel(level);
  document.getElementById("info").textContent =
    "L"+level+" - "+shape.toUpperCase();

  drawShape(shape);

  // physics
  ball.vx += tiltX;
  ball.vy += tiltY;
  ball.vx *= 0.98;
  ball.vy *= 0.98;
  ball.x += ball.vx;
  ball.y += ball.vy;

  // draw ball
  ctx.fillStyle="gold";
  ctx.beginPath();
  ctx.arc(ball.x,ball.y,ball.r,0,Math.PI*2);
  ctx.fill();

  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
